<!DOCTYPE html>
<!--[if IE 9]> <html lang="en" class="ie9"> <![endif]-->
<!--[if !IE]><!-->
<html lang="en">
<!--<![endif]-->
	<head>
		<meta charset="utf-8"></meta>
		<title>Worthy | Free Powerful Theme by HtmlCoder</title>
		<meta name="description" content="Worthy a Bootstrap-based, Responsive HTML5 Template"></meta>
		<meta name="author" content="htmlcoder.me"></meta>

		<!-- Mobile Meta -->
		<meta name="viewport" content="width=device-width, initial-scale=1.0"></meta>

		<!-- Favicon -->
		<link rel="shortcut icon" href="images/favicon.ico"></link>

		<!-- Web Fonts -->
		<link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700,300&amp;subset=latin,latin-ext' rel='stylesheet' type='text/css'></link>
		<link href='http://fonts.googleapis.com/css?family=Raleway:700,400,300' rel='stylesheet' type='text/css'></link>

		<!-- Bootstrap core CSS -->
		<link href="bootstrap/css/bootstrap.css" rel="stylesheet"></link>

		<!-- Font Awesome CSS -->
		<link href="fonts/font-awesome/css/font-awesome.css" rel="stylesheet"></link>

		<!-- Plugins -->
		<link href="css/animations.css" rel="stylesheet"></link>

		<!-- Worthy core CSS file -->
		<link href="css/style.css" rel="stylesheet"></link>

		<!-- Custom css --> 
		<link href="css/custom.css" rel="stylesheet" ></link>
	</head>

	<body class="no-trans">
		<!-- scrollToTop -->
		<!-- ================ -->
		<div class="scrollToTop"><i class="icon-up-open-big"></i></div>

		<!-- header start -->
		<!-- ================ --> 
		<header class="header fixed clearfix navbar navbar-fixed-top">
			<div class="container">
				<div class="row">
					<div class="col-md-4">

						<!-- header-left start -->
						<!-- ================ -->
						<div class="header-left clearfix">

							<!-- logo -->
							<div class="logo smooth-scroll">
								<a href="#banner"><img id="logo" src="images/logo.jpg" alt="Worthy"></img></a>
							</div>

							<!-- name-and-slogan -->
							<div class="site-name-and-slogan smooth-scroll">
								<div class="site-name"><a href="#banner">AD master</a></div>
								<div class="site-slogan">Powered by BOSCH XDK and Microsoft face recognition api</div>
							</div>

						</div>
						<!-- header-left end -->

					</div>
					
				</div>
			</div>
		</header>

		<!-- section start -->
		<!-- ================ -->
		<div class="section clearfix object-non-visible" data-animation-effect="fadeIn">
			<div class="container">
				<div class="row">
					<div class="col-md-12">
						<!-- h1 id="about" class="title text-center">About <span>Worthy</span></h1>
						<p class="lead text-center">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dicta officia, aspernatur.</p -->
						<div class="space"></div>
						<div class="space"></div>
						<div class="space"></div>
						<div class="row">
							<div class="col-md-8">
								<img id="ad" src="images/ad0.jpg" alt=""></img>
								<div class="space"></div>
							</div>
							<div class="col-md-4">
								<img id="cam" src="../test.jpg" alt="not found"></img>
								<br></br>
								<ul class="list-unstyled">
									<li id="date"></li>
									<li id="temperature"></li>
									<li id="humidity"></li>
									<li id="people"></li>
									<li id="age"></li>
									<li id="gender"></li>
									<li>Contact us: 123-456-7890</li>
								</ul>
								<p><br></br></p>
								<p><br></br></p>
								<p><br></br></p>
								<p><br></br></p>
								<p><br></br></p>
								<p><br></br></p>
								<p><br></br></p>
								<p><br></br></p>
								<p><br></br></p>
								<p><br></br></p>
								<p><br></br></p>
								<p><br></br></p>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<!-- section end -->

		<!-- JavaScript files placed at the end of the document so the pages load faster
		================================================== -->
		<!-- Jquery and Bootstap core js files -->
		<script type="text/javascript" src="plugins/jquery.min.js"></script>
		<script type="text/javascript" src="bootstrap/js/bootstrap.min.js"></script>

		<!-- Modernizr javascript -->
		<script type="text/javascript" src="plugins/modernizr.js"></script>

		<!-- Isotope javascript -->
		<script type="text/javascript" src="plugins/isotope/isotope.pkgd.min.js"></script>
		
		<!-- Backstretch javascript -->
		<script type="text/javascript" src="plugins/jquery.backstretch.min.js"></script>

		<!-- Appear javascript -->
		<script type="text/javascript" src="plugins/jquery.appear.js"></script>

		<!-- Initialization of Plugins -->
		<script type="text/javascript" src="js/template.js"></script>

		<!-- Custom Scripts -->
		<script type="text/javascript" src="js/custom.js"> </script>
		<!--script type="text/javascript" src="js/refresh.js"> </script -->
		
		<!-- advertisement refresh loop -->
		<script type="text/javascript">
			// # of ads within a set
			var n = 3;
			// current ad indext in the current set
			var c = 0;
			function updateAd(){
				$("#ad").fadeOut("10000");
				$("#ad").replaceWith( "<img id='ad' src='" + slots[(c+1)%3] + "' alt=''>");
				$('#ad').fadeIn("10000");
			}

			function refresh(){
				updateAD();
				$("#cam").fadeOut();
				d = new Date();
				$("#cam").attr("src", "../test.jpg?"+d.getTime());
				$("#cam").fadeIn();
				//$("#cam").replaceWith( "<img id='cam' src='../test.jpg' alt=''>");
				//console.log($("#ad").src);
				c = (c+1)%n;
				setTimeout("refresh()", 5000);
				if (c==2){
					// resend a get request
					sendReq();
				}
			}

			// initialize full imgs set and n slots
			var imgs = new Array();
			for (var i=0; i<20; i++){
				imgs[i] = "images/ad" + i + ".jpg";
			}
			var slots = new Array();
			for (var i=0; i<n; i++){
				slots[i] = imgs[i];
			}
			setTimeout("refresh()", 5000);
			/*
			// video stream
			function video(){
				$("#cam").replaceWith( "<img id='cam' src='../test.jpg' alt=''>");
				setTimeout("video()", 1000);
			}
			setTimeout("video()",1000);
			
			*/
			var date = "future";
			var temperature = "-273";
			var humidity = "100";
			var age = "999";
			var gender = "futa";
			var number = "0";

			function updateText(){
				$("#date").html("Date: "+date);
				$("#temperature").html("Temperature: "+ temperature +" C");
				$("#humidity").html("Humidity: "+ humidity +"%");
				$("#age").html("Age: "+ age );
				$("#gender").html("Gender: "+ gender );
				$("#people").html("People: "+ number);
			}
			//updageText();
			

			// server's url
			function sendReq(){
				//var url = "http://172.31.11.38:8000/sensors/";
				var url = "http://139.219.188.151:8000/sensors/"
				$.ajax({
					url: url + "&callback=?",
					type:'GET',
					success: function(resp){
						//alert(resp);
						var obj = JSON.parse(resp);
						slots[0] = imgs[obj.index1];
						slots[1] = imgs[obj.index2];
						slots[2] = imgs[obj.index3];
						if (obj.gender=="male"){
							slots[0] = "images/ad" + 7 + ".jpg";
							slots[1] = "images/ad" + 18 + ".jpg";
							if ( parseInt(obj.temperature) >30 ){
								slots[2] = "images/ad" + 4 + ".jpg";
							}else{
								slots[2] = "images/ad" + 15 + ".jpg";
							}
						}else if (obj.gender=="female"){
							slots[0] = "images/ad" + 14 + ".jpg";
							slots[1] = "images/ad" + 10 + ".jpg";
							if ( parseInt(obj.temperature) >30 ){
								slots[2] = "images/ad" + 3 + ".jpg";
							}else{
								slots[2] = "images/ad" + 2 + ".jpg";
							}
						}else{
							slots[0] = "images/ad" + 1 + ".jpg";
							slots[1] = "images/ad" + 9 + ".jpg";
							slots[2] = "images/ad" + 10 + ".jpg";
						}
						date = obj.time;
						temperature = obj.temperature;
						humidity = obj.humidity;
						age = obj.age;
						gender = obj.gender;
						number = obj.humanNum;
						updateText();
						updateAD();
						// console.log(slots[0]);
						// console.log(slots[1]);
						// console.log(slots[2]);
						// console.log(age);
						// console.log(gender);
					},
					error: function(e){
						alert('Error:'+e);
					}
				});
			}
			
			sendReq();
			
		</script>
	</body>
</html>
